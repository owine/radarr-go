{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:base",
    "docker:enableMajor",
    ":dependencyDashboard",
    ":semanticCommits",
    ":separateMultipleMajorReleases",
    ":combinePatchMinorReleases",
    "group:monorepos",
    "group:recommended",
    "workarounds:all"
  ],
  "timezone": "UTC",
  "schedule": ["before 6am on monday"],
  "labels": ["dependencies"],
  "commitMessagePrefix": "deps:",
  "commitMessageAction": "update",
  "commitMessageTopic": "{{depName}}",
  "commitMessageExtra": "to {{newVersion}}",
  "prHourlyLimit": 2,
  "prConcurrentLimit": 10,
  "branchConcurrentLimit": 20,
  "semanticCommits": "enabled",
  "platformAutomerge": true,
  "assigneesFromCodeOwners": true,
  "reviewersFromCodeOwners": true,
  "vulnerabilityAlerts": {
    "labels": ["security"],
    "assignees": ["@radarr/security-team"]
  },
  "lockFileMaintenance": {
    "enabled": true,
    "schedule": ["before 6am on monday"],
    "commitMessageAction": "lock file maintenance"
  },
  "packageRules": [
    {
      "description": "Go modules",
      "matchManagers": ["gomod"],
      "rangeStrategy": "bump",
      "semanticCommitType": "deps",
      "automerge": true,
      "automergeType": "pr",
      "requiredStatusChecks": null,
      "minimumReleaseAge": "3 days",
      "internalChecksFilter": "strict",
      "addLabels": ["go"]
    },
    {
      "description": "Go major updates",
      "matchManagers": ["gomod"],
      "matchUpdateTypes": ["major"],
      "automerge": false,
      "addLabels": ["major-update"],
      "reviewers": ["@radarr/maintainers"]
    },
    {
      "description": "Go patch and minor updates",
      "matchManagers": ["gomod"],
      "matchUpdateTypes": ["patch", "minor"],
      "automerge": true,
      "automergeType": "pr"
    },
    {
      "description": "Security updates",
      "matchPackagePatterns": ["*"],
      "matchUpdateTypes": ["patch"],
      "isVulnerabilityAlert": true,
      "addLabels": ["security"],
      "automerge": true,
      "automergeType": "pr",
      "schedule": ["at any time"],
      "prPriority": 10
    },
    {
      "description": "Docker images",
      "matchManagers": ["dockerfile", "docker-compose"],
      "automerge": true,
      "automergeType": "pr",
      "addLabels": ["docker"],
      "minimumReleaseAge": "3 days"
    },
    {
      "description": "Docker major updates",
      "matchManagers": ["dockerfile", "docker-compose"],
      "matchUpdateTypes": ["major"],
      "automerge": false,
      "addLabels": ["major-update", "docker"]
    },
    {
      "description": "GitHub Actions",
      "matchManagers": ["github-actions"],
      "automerge": true,
      "automergeType": "pr",
      "addLabels": ["github-actions"],
      "minimumReleaseAge": "3 days"
    },
    {
      "description": "Pin GitHub Actions to exact versions",
      "matchManagers": ["github-actions"],
      "rangeStrategy": "pin"
    },
    {
      "description": "Critical Go dependencies - manual review",
      "matchManagers": ["gomod"],
      "matchPackageNames": [
        "github.com/gin-gonic/gin",
        "gorm.io/gorm",
        "github.com/golang-migrate/migrate/v4"
      ],
      "automerge": false,
      "addLabels": ["critical-dependency"],
      "reviewers": ["@radarr/maintainers"]
    },
    {
      "description": "Test dependencies",
      "matchManagers": ["gomod"],
      "matchPackageNames": [
        "github.com/stretchr/testify"
      ],
      "addLabels": ["testing"],
      "automerge": true
    },
    {
      "description": "Database drivers",
      "matchManagers": ["gomod"],
      "matchPackagePatterns": [
        "github.com/lib/pq",
        "github.com/mattn/go-sqlite3",
        "gorm.io/driver/*"
      ],
      "addLabels": ["database"],
      "automerge": false,
      "reviewers": ["@radarr/maintainers"]
    },
    {
      "description": "Go version updates",
      "matchManagers": ["gomod"],
      "matchDepTypes": ["golang"],
      "rangeStrategy": "replace",
      "automerge": false,
      "addLabels": ["golang-version", "major-update"],
      "reviewers": ["@radarr/maintainers"]
    }
  ],
  "regexManagers": [
    {
      "description": "Update Go version in Dockerfile",
      "fileMatch": ["^Dockerfile$"],
      "matchStrings": [
        "FROM golang:(?<currentValue>.*?)-alpine"
      ],
      "depNameTemplate": "golang",
      "datasourceTemplate": "docker"
    },
    {
      "description": "Update Go version in GitHub Actions",
      "fileMatch": ["^\\.github/workflows/.*\\.ya?ml$"],
      "matchStrings": [
        "go-version: ['\"]?(?<currentValue>.*?)['\"]?"
      ],
      "depNameTemplate": "golang",
      "datasourceTemplate": "golang-version"
    }
  ],
  "customManagers": [
    {
      "customType": "regex",
      "description": "Update alpine version in Dockerfile",
      "fileMatch": ["^Dockerfile$"],
      "matchStrings": [
        "FROM alpine:(?<currentValue>.*?)\\s"
      ],
      "depNameTemplate": "alpine",
      "datasourceTemplate": "docker"
    }
  ]
}